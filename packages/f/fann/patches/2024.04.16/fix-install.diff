diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
index ac3ff73..27f9a35 100644
--- a/src/CMakeLists.txt
+++ b/src/CMakeLists.txt
@@ -25,13 +25,20 @@ SET(floatfann_LIB_SRCS
 
 ADD_LIBRARY(floatfann SHARED ${floatfann_LIB_SRCS})
 ADD_LIBRARY(floatfann_static STATIC ${floatfann_LIB_SRCS})
+if (BUILD_SHARED_LIBS)
+SET_TARGET_PROPERTIES(floatfann_static PROPERTIES EXCLUDE_FROM_ALL 1)
+SET(floatfann_target floatfann)
+else ()
+SET_TARGET_PROPERTIES(floatfann PROPERTIES EXCLUDE_FROM_ALL 1)
+SET(floatfann_target floatfann_static)
+endif ()
 
 SET_TARGET_PROPERTIES(floatfann PROPERTIES VERSION ${FANN_VERSION_STRING} SOVERSION ${FANN_VERSION_MAJOR})
 SET_TARGET_PROPERTIES(floatfann_static PROPERTIES VERSION ${FANN_VERSION_STRING} SOVERSION ${FANN_VERSION_MAJOR})
 if (UNIX)
   SET_TARGET_PROPERTIES(floatfann_static PROPERTIES OUTPUT_NAME floatfann)
 endif(UNIX)
-INSTALL(TARGETS floatfann floatfann_static LIBRARY DESTINATION ${LIB_INSTALL_DIR}
+INSTALL(TARGETS ${floatfann_target} LIBRARY DESTINATION ${LIB_INSTALL_DIR}
         ARCHIVE DESTINATION ${LIB_INSTALL_DIR}
         RUNTIME DESTINATION ${BIN_INSTALL_DIR} )
 
@@ -44,13 +51,20 @@ SET(doublefann_LIB_SRCS
 
 ADD_LIBRARY(doublefann SHARED ${doublefann_LIB_SRCS})
 ADD_LIBRARY(doublefann_static STATIC ${doublefann_LIB_SRCS})
+if (BUILD_SHARED_LIBS)
+SET_TARGET_PROPERTIES(doublefann_static PROPERTIES EXCLUDE_FROM_ALL 1)
+SET(doublefann_target doublefann)
+else ()
+SET_TARGET_PROPERTIES(doublefann PROPERTIES EXCLUDE_FROM_ALL 1)
+SET(doublefann_target doublefann_static)
+endif ()
 
 SET_TARGET_PROPERTIES(doublefann PROPERTIES VERSION ${FANN_VERSION_STRING} SOVERSION ${FANN_VERSION_MAJOR})
 SET_TARGET_PROPERTIES(doublefann_static PROPERTIES VERSION ${FANN_VERSION_STRING} SOVERSION ${FANN_VERSION_MAJOR})
 if (UNIX)
   SET_TARGET_PROPERTIES(doublefann_static PROPERTIES OUTPUT_NAME doublefann)
 endif(UNIX)
-INSTALL(TARGETS doublefann doublefann_static LIBRARY DESTINATION ${LIB_INSTALL_DIR}
+INSTALL(TARGETS ${doublefann_target} LIBRARY DESTINATION ${LIB_INSTALL_DIR}
         ARCHIVE DESTINATION ${LIB_INSTALL_DIR}
         RUNTIME DESTINATION ${BIN_INSTALL_DIR} )
 
@@ -63,6 +77,13 @@ SET(fixedfann_LIB_SRCS
 
 ADD_LIBRARY(fixedfann SHARED ${fixedfann_LIB_SRCS})
 ADD_LIBRARY(fixedfann_static STATIC ${fixedfann_LIB_SRCS})
+if (BUILD_SHARED_LIBS)
+SET_TARGET_PROPERTIES(fixedfann_static PROPERTIES EXCLUDE_FROM_ALL 1)
+SET(fixedfann_target fixedfann)
+else ()
+SET_TARGET_PROPERTIES(fixedfann PROPERTIES EXCLUDE_FROM_ALL 1)
+SET(fixedfann_target fixedfann_static)
+endif ()
 
 if(NOT MSVC)
 TARGET_LINK_LIBRARIES(fixedfann m)
@@ -74,7 +95,7 @@ SET_TARGET_PROPERTIES(fixedfann_static PROPERTIES VERSION ${FANN_VERSION_STRING}
 if (UNIX)
   SET_TARGET_PROPERTIES(fixedfann_static PROPERTIES OUTPUT_NAME fixedfann)
 endif(UNIX)
-INSTALL(TARGETS fixedfann fixedfann_static LIBRARY DESTINATION ${LIB_INSTALL_DIR}
+INSTALL(TARGETS ${fixedfann_target} LIBRARY DESTINATION ${LIB_INSTALL_DIR}
         ARCHIVE DESTINATION ${LIB_INSTALL_DIR}
         RUNTIME DESTINATION ${BIN_INSTALL_DIR} )
 
@@ -87,6 +108,13 @@ SET(fann_LIB_SRCS
 
 ADD_LIBRARY(fann SHARED ${fann_LIB_SRCS})
 ADD_LIBRARY(fann_static STATIC ${fann_LIB_SRCS})
+if (BUILD_SHARED_LIBS)
+SET_TARGET_PROPERTIES(fann_static PROPERTIES EXCLUDE_FROM_ALL 1)
+SET(fann_target fann)
+else ()
+SET_TARGET_PROPERTIES(fann PROPERTIES EXCLUDE_FROM_ALL 1)
+SET(fann_target fann_static)
+endif ()
 
 if(NOT MSVC)
 TARGET_LINK_LIBRARIES(fann m)
@@ -98,6 +126,6 @@ SET_TARGET_PROPERTIES(fann_static PROPERTIES VERSION ${FANN_VERSION_STRING} SOVE
 if (UNIX)
   SET_TARGET_PROPERTIES(fann_static PROPERTIES OUTPUT_NAME fann)
 endif(UNIX)
-INSTALL(TARGETS fann fann_static LIBRARY DESTINATION ${LIB_INSTALL_DIR}
+INSTALL(TARGETS ${fann_target} LIBRARY DESTINATION ${LIB_INSTALL_DIR}
         ARCHIVE DESTINATION ${LIB_INSTALL_DIR}
         RUNTIME DESTINATION ${BIN_INSTALL_DIR} )
